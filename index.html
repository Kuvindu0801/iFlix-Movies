<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>iFlix</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        crossorigin="anonymous" />
    <script src="https://kit.fontawesome.com/b93aae0615.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="assets/css/styles.css" />
    <link rel="shortcut icon" href="assets/img/icons8-movie-ticket-16.png" />
</head>

<body>
    <!-- NAVBAR -->
    <nav class="navbar">
        <div class="navbar-container">
            <h1 class="logo">iFlix</h1>
        </div>
        <div class="menu-container">
            <ul class="menu-list">
                <li><a href="index.html" class="menu-list-item active">Home</a></li>
                <li><a href="movies.html" class="menu-list-item">Movies</a></li>
                <li><a href="tvshows.html" class="menu-list-item ">TV Shows</a></li>
                
            </ul>
        </div>
        <div class="profile-text-container">
            <span class="profile-text"><i class="fa-solid fa-user"></i> Profile</span>
        </div>
    </nav>

    <!-- SIDEBAR -->
    <aside class="sidebar">
        <a href="index.html" aria-label="Home"><i class="left-menu-icon fa-solid fa-house" id="active"></i></a>
        <a href="trending.html"><i class="left-menu-icon fa-solid fa-fire"></i></a>
        <a href="browse.html" aria-label="Browse"><i class="left-menu-icon fa-solid fa-compass"></i></a>
        <a href="tvshows.html" aria-label="TV Shows"><i class="left-menu-icon fa-solid fa-tv"></i></a>
        <a href="bookmarks.html" aria-label="Bookmarks"><i class="left-menu-icon fa-solid fa-bookmark"></i></a>
    </aside>

    <!-- MAIN CONTAINER -->
    <main class="container">
        <!-- HERO -->
        <section class="hero-container"
            style="background: url('assets/img/videotape-with-popcorns-3d-glasses.jpg'); background-repeat: no-repeat; background-position: center center; background-attachment: fixed; background-size: cover;">
            <div class="title">
                <h1 class="main-title"><i class="fa-solid fa-ticket-simple fa-rotate-by"
                        style="color: #7a0505; --fa-rotate-angle: 340deg;"></i> iFlix.</h1>
            </div>
        </section>

        <!-- MOVIE LIST -->
          <h1 class="Main-Title">Now Playing</h1>
            <h2 class="sub-title">Movies</h2>
          <div id="nowplaying-movies-container"></div>
        <!-- TV SHOW LIST -->
         <h1 class="Main-Title">Now Playing</h1>
            <h2 class="sub-title">TV Shows</h2>
          <div id="nowplaying-TV-container"></div>
    </main>
    <script>
        // API KEY
        const apiKey = '2ddc93d4834d63671d94572934ee483b';


        // GET TRENDING MOVIES
        async function getNowPlayingMovies() {
            try {
                const response = await fetch(`https://api.themoviedb.org/3/movie/now_playing?api_key=${apiKey}`);
                if (!response.ok) throw new Error('Network response was not ok');
                const data = await response.json();
                displayMovies(data.results);
            } catch (error) {
                console.error('Failed to fetch trending movies:', error);
            }
        }

        function displayMovies(movies) {
            const container = document.getElementById('nowplaying-movies-container');
            container.innerHTML = '';
            movies.forEach(movie => {
                const movieElem = document.createElement('div');
                movieElem.classList.add('movie');

                // Movie poster url construction
                const posterUrl = movie.poster_path
                    ? `https://image.tmdb.org/t/p/w200${movie.poster_path}`
                    : 'https://via.placeholder.com/200x300?text=No+Image';

                movieElem.innerHTML = `
          <img src="${posterUrl}" alt="${movie.title} poster"/>
          <div class="movie-title">${movie.title}</div>
        `;

                container.appendChild(movieElem);
            });
        }

        getNowPlayingMovies();

        async function getNowPlayingTV() {
            try {
                const response = await fetch(`https://api.themoviedb.org/3/tv/airing_today?api_key=${apiKey}`);
                if (!response.ok) throw new Error('Network response was not ok');
                const data = await response.json();
                displayTV(data.results);
            } catch (error) {
                console.error('Failed to fetch trending movies:', error);
            }
        }

        function displayTV(TV) {
            const container = document.getElementById('nowplaying-TV-container');
            container.innerHTML = '';
            TV.forEach(Tv => {
                const TVElem = document.createElement('div');
                TVElem.classList.add('Tv');

                // Movie poster url construction
                const posterUrl = Tv.poster_path
                    ? `https://image.tmdb.org/t/p/w200${Tv.poster_path}`
                    : 'https://via.placeholder.com/200x300?text=No+Image';

                TVElem.innerHTML = `
          <img src="${posterUrl}" alt="${Tv.title} poster"/>
          <div class="Tv-title">${Tv.name}</div>
        `;

                container.appendChild(TVElem);
            });
        }

        getNowPlayingTV();
    </script>
</body>

</html>