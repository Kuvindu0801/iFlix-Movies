<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iFlix</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/b93aae0615.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="assets/css/browser.css">
    <link rel="shortcut icon" href="assets/img/icons8-movie-ticket-16.png" />

</head>

<body>
    <!-- NAVBAR -->
    <div class="navbar">
        <div class="navbar-container">
            <h1 class="logo">iFlix</h1>
        </div>
        <div class="menu-container">
            <ul class="menu-list">
                <a href="index.html">
                    <li class="menu-list-item">Home</li>
                </a>
                <a href="movies.html">
                    <li class="menu-list-item active">Movies</li>
                </a>
                <a href="tvshows.html">
                    <li class="menu-list-item">TV Shows</li>
                </a>
            </ul>
        </div>
        <div class="profile-text-container">
            <span class="profile-text"><i class="fa-solid fa-user"></i>Profile</span>
        </div>
    </div>

    <!-- SIDEBAR -->
    <div class="sidebar">
        <a href="index.html"><i class="left-menu-icon fa-solid fa-house"></i></a>
        <a href="trending.html"><i class="left-menu-icon fa-solid fa-fire"></i></a>
        <a href="browse.html"><i class="left-menu-icon fa-solid fa-compass active"></i></a>
        <a href="tvshows.html"><i class="left-menu-icon fa-solid fa-tv"></i></a>
        <a href=""><i class="left-menu-icon fa-solid fa-bookmark"></i></a>
    </div>

    <!-- SEARCH CONTROLS -->
    <div class="search-container">
        <input type="text" id="searchInput1" placeholder="Search movies..." />
        <button id="searchBtn">Search</button>
    </div>

    <!-- SEARCH TYPE RADIO BUTTONS -->
    <div class="radio-group">
        <input type="radio" name="searchType" id="search1" value="title" checked>
        <label for="search1">By Title</label>

        <input type="radio" name="searchType" id="search2" value="keyword">
        <label for="search2">By Keyword</label>

        <input type="radio" name="searchType" id="search3" value="id">
        <label for="search3">By IMDb ID</label>
    </div>

    <!-- MOVIES CONTAINER -->
    <div id="movies" class="movies">
        <p>Search for movies above to get started!</p>
    </div>

    <script>
    // API Configuration
const apiKey = '3262713e';
const searchInput = document.getElementById('searchInput1');
const searchBtn = document.getElementById('searchBtn');
const moviesContainer = document.getElementById('movies');
const search1 = document.getElementById('search1');
const search2 = document.getElementById('search2');
const search3 = document.getElementById('search3');

// Event Listeners
search1.addEventListener('click', handleSearch);
searchBtn.addEventListener('click', handleSearch);
searchInput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') handleSearch();
});

async function handleSearch() {
    const query = searchInput.value.trim();
    if (!query) {
        moviesContainer.innerHTML = '<p>Please enter a search term.</p>';
        return;
    }

    const searchType = document.querySelector('input[name="searchType"]:checked').value;
    await performSearch(query, searchType);
}

async function performSearch(query, type) {
    moviesContainer.innerHTML = '<p>Loading...</p>';

    try {
        let url;
        if (type === 'id') {
            // Use 'i' parameter for ID lookup
            url = `http://www.omdbapi.com/?apikey=${apiKey}&i=${encodeURIComponent(query)}`;
        } else {
            // Use 's' parameter for search by title or keyword
            url = `http://www.omdbapi.com/?apikey=${apiKey}&s=${encodeURIComponent(query)}`;
        }

        const response = await fetch(url);
        const data = await response.json();

        if (data.Error) {
            moviesContainer.innerHTML = `<p>${data.Error}</p>`;
            return;
        }

        if (type === 'id' && !data.Title) {
            moviesContainer.innerHTML = '<p>Movie not found.</p>';
            return;
        }

        displayMovies(type === 'id' ? [data] : data.Search);
    } catch (error) {
        moviesContainer.innerHTML = '<p>Error loading movies. Please try again.</p>';
        console.error('Search error:', error);
    }
}

function displayMovies(movies) {
    if (!movies || movies.length === 0) {
        moviesContainer.innerHTML = '<p>No movies found.</p>';
        return;
    }

    moviesContainer.innerHTML = '';
    movies.forEach(movie => {
        const movieEl = document.createElement('div');
        movieEl.classList.add('movie');

        const posterPath = (movie.Poster && movie.Poster !== 'N/A')
            ? movie.Poster
            : 'https://via.placeholder.com/200x300?text=No+Image';

        movieEl.innerHTML = `
            <a href="details.html?movieId=${movie.imdbID}" style="text-decoration:none; color:inherit;">
                <img src="${posterPath}" alt="${movie.Title}" loading="lazy" />
                <div class="movie-info">
                    <p class="movie-title">${movie.Title}</p>
                    <p class="movie-date">${movie.Year || 'Unknown'}</p>
                    ${movie.imdbID ? `<p>IMDb: ${movie.imdbID}</p>` : ''}
                </div>
            </a>
        `;

        moviesContainer.appendChild(movieEl);
    });
}

    </script>
</body>

</html>